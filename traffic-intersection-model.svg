<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1406px" preserveAspectRatio="none" style="width:1494px;height:1406px;background:#FFFFFF;" version="1.1" viewBox="0 0 1494 1406" width="1494px" zoomAndPan="magnify"><defs><filter height="300%" id="f1fszsm3fj72wa" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[c317431f81cdf0e8053db5837ef6c822]
class TrafficLightStates--><rect codeLine="2" fill="#FEFECE" filter="url(#f1fszsm3fj72wa)" height="97.6953" id="TrafficLightStates" style="stroke:#A80036;stroke-width:1.5;" width="127" x="7" y="404"/><ellipse cx="22" cy="424.0938" fill="#EB937F" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M20.5,425.0938 L20.5,427.0938 L24.5,427.0938 L24.5,426.0938 L24.5,425.6094 L25.125,425.0938 L25.5,425.0938 L25.875,425.0938 L26.5,425.6094 L26.5,426.0938 L26.5,429.0938 L18.5,429.0938 L18.0156,429.0938 L17.5,428.4688 L17.5,428.0938 L17.5,427.7188 L18.0156,427.0938 L18.5,427.0938 L18.5,427.0938 L18.5,421.0938 L18.5,421.0938 L18.0156,421.0938 L17.5,420.4688 L17.5,420.0938 L17.5,419.7188 L18.0156,419.0938 L18.5,419.0938 L26.5,419.0938 L26.5,422.0938 L26.5,422.5781 L25.875,423.0938 L25.5,423.0938 L25.125,423.0938 L24.5,422.5781 L24.5,422.0938 L24.5,421.0938 L20.5,421.0938 L20.5,423.0938 L21.5,423.0938 L21.5,422.6094 L21.5,422.6094 L22.125,422.0938 L22.5,422.0938 L22.875,422.0938 L23.5,422.6094 L23.5,423.0938 L23.5,425.0938 L23.5,425.5781 L22.875,426.0938 L22.875,426.0938 L22.5,426.0938 L22.125,426.0938 L21.5,425.5781 L21.5,425.5781 L21.5,425.0938 L20.5,425.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="64" x="51.5" y="421.457">«fsm-state»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="95" x="36" y="436.5508">TrafficLightStates</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="133" y1="444.1875" y2="444.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="20" x="13" y="459.6064">RED</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="36" x="13" y="473.4424">AMBER</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="34" x="13" y="487.2783">GREEN</text><line style="stroke:#A80036;stroke-width:1.5;" x1="8" x2="133" y1="493.6953" y2="493.6953"/><!--MD5=[082ea4b1b4c949e9e678c41ae71c099b]
class TrafficLightEvents--><rect codeLine="8" fill="#FEFECE" filter="url(#f1fszsm3fj72wa)" height="83.8594" id="TrafficLightEvents" style="stroke:#A80036;stroke-width:1.5;" width="129" x="207" y="808"/><ellipse cx="222" cy="828.0938" fill="#EB937F" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M220.5,829.0938 L220.5,831.0938 L224.5,831.0938 L224.5,830.0938 L224.5,829.6094 L225.125,829.0938 L225.5,829.0938 L225.875,829.0938 L226.5,829.6094 L226.5,830.0938 L226.5,833.0938 L218.5,833.0938 L218.0156,833.0938 L217.5,832.4688 L217.5,832.0938 L217.5,831.7188 L218.0156,831.0938 L218.5,831.0938 L218.5,831.0938 L218.5,825.0938 L218.5,825.0938 L218.0156,825.0938 L217.5,824.4688 L217.5,824.0938 L217.5,823.7188 L218.0156,823.0938 L218.5,823.0938 L226.5,823.0938 L226.5,826.0938 L226.5,826.5781 L225.875,827.0938 L225.5,827.0938 L225.125,827.0938 L224.5,826.5781 L224.5,826.0938 L224.5,825.0938 L220.5,825.0938 L220.5,827.0938 L221.5,827.0938 L221.5,826.6094 L221.5,826.6094 L222.125,826.0938 L222.5,826.0938 L222.875,826.0938 L223.5,826.6094 L223.5,827.0938 L223.5,829.0938 L223.5,829.5781 L222.875,830.0938 L222.875,830.0938 L222.5,830.0938 L222.125,830.0938 L221.5,829.5781 L221.5,829.5781 L221.5,829.0938 L220.5,829.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="68" x="250.5" y="825.457">«fsm-event»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="97" x="236" y="840.5508">TrafficLightEvents</text><line style="stroke:#A80036;stroke-width:1.5;" x1="208" x2="335" y1="848.1875" y2="848.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="27" x="213" y="863.6064">STOP</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="16" x="213" y="877.4424">GO</text><line style="stroke:#A80036;stroke-width:1.5;" x1="208" x2="335" y1="883.8594" y2="883.8594"/><!--MD5=[a07046c479290317f8cce38738edece0]
class TrafficLight--><rect codeLine="13" fill="#FEFECE" filter="url(#f1fszsm3fj72wa)" height="236.0547" id="TrafficLight" style="stroke:#A80036;stroke-width:1.5;" width="397" x="410" y="335"/><ellipse cx="567.75" cy="355.0938" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M568.75,352.0938 L568.75,358.0938 L570.75,358.0938 L571.2344,358.0938 L571.75,358.7188 L571.75,359.0938 L571.75,359.4688 L571.2344,360.0938 L570.75,360.0938 L564.75,360.0938 L564.2656,360.0938 L563.75,359.4688 L563.75,359.0938 L563.75,358.7188 L564.2656,358.0938 L564.75,358.0938 L566.75,358.0938 L566.75,352.0938 L564.75,352.0938 L564.2656,352.0938 L563.75,351.4688 L563.75,351.0938 L563.75,350.7188 L564.2656,350.0938 L564.75,350.0938 L570.75,350.0938 L571.2344,350.0938 L571.75,350.7188 L571.75,351.0938 L571.75,351.4688 L571.2344,352.0938 L570.75,352.0938 L568.75,352.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="77" x="586.25" y="352.457">«fsm-context»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="60" x="594.75" y="367.5508">TrafficLight</text><line style="stroke:#A80036;stroke-width:1.5;" x1="411" x2="806" y1="375.1875" y2="375.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="60" x="416" y="390.6064">name: String</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="97" x="416" y="404.4424">amberTimeout: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="75" x="416" y="418.2783">amber: Boolean</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="61" x="416" y="432.1143">red: Boolean</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="73" x="416" y="445.9502">green: Boolean</text><line style="stroke:#A80036;stroke-width:1.5;" x1="411" x2="806" y1="452.3672" y2="452.3672"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="169" x="416" y="467.7861">changeAmberTimeout(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="224" x="416" y="481.6221">setNotifyStopped(receiver: suspend () -&gt; Unit)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="385" x="416" y="495.458">setNotifyStateChange(receiver: suspend (newState: TrafficLightStates) -&gt; Unit)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="416" y="509.2939">stopped() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="174" x="416" y="523.1299">switchRed(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="187" x="416" y="536.9658">switchAmber(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="185" x="416" y="550.8018">switchGreen(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="258" x="416" y="564.6377">stateChanged(toState: TrafficLightStates) «suspend»</text><!--MD5=[8f5d905706df63f012d7d74357fff60c]
class TrafficLightFSM--><rect codeLine="30" fill="#FEFECE" filter="url(#f1fszsm3fj72wa)" height="83.8594" id="TrafficLightFSM" style="stroke:#A80036;stroke-width:1.5;" width="118" x="212.5" y="411"/><ellipse cx="228.4" cy="431.0938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M230.4,427.5938 Q230.6031,427.0938 230.8375,426.8438 Q231.0719,426.5938 231.3375,426.5938 Q231.8063,426.5938 232.1031,426.875 Q232.4,427.1563 232.4,427.8125 L232.4,429.375 Q232.4,430.0313 232.1188,430.3125 Q231.8375,430.5938 231.4,430.5938 Q231.0094,430.5938 230.7594,430.4219 Q230.5094,430.25 230.4,429.7969 Q230.3531,429.4844 230.1813,429.3125 Q229.8688,428.9844 229.3063,428.7969 Q228.7438,428.5938 228.1813,428.5938 Q227.4781,428.5938 226.8844,428.875 Q226.3063,429.1563 225.8531,429.7813 Q225.4,430.4063 225.4,431.2656 L225.4,432.1875 Q225.4,433.2188 226.2438,433.9063 Q227.0875,434.5938 228.5875,434.5938 Q229.4781,434.5938 230.1031,434.3906 Q230.4625,434.2813 230.8688,433.9219 Q231.1344,433.7188 231.275,433.6563 Q231.4156,433.5938 231.5875,433.5938 Q231.9156,433.5938 232.15,433.8594 Q232.4,434.1094 232.4,434.4688 Q232.4,434.8125 232.0563,435.2188 Q231.5563,435.8125 230.7594,436.1406 Q229.7125,436.5938 228.4313,436.5938 Q226.9313,436.5938 225.7281,436 Q224.7594,435.5313 224.0719,434.5156 Q223.4,433.5 223.4,432.2969 L223.4,431.2031 Q223.4,429.9531 223.9938,428.8594 Q224.6031,427.7656 225.65,427.1875 Q226.7125,426.5938 227.9,426.5938 Q228.6188,426.5938 229.2438,426.8438 Q229.8688,427.0938 230.4,427.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="267.6" y="428.457">«fsm»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="84" x="242.6" y="443.5508">TrafficLightFSM</text><line style="stroke:#A80036;stroke-width:1.5;" x1="213.5" x2="329.5" y1="451.1875" y2="451.1875"/><line style="stroke:#A80036;stroke-width:1.5;" x1="213.5" x2="329.5" y1="459.1875" y2="459.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="106" x="218.5" y="474.6064">fun start() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="105" x="218.5" y="488.4424">fun stop() «suspend»</text><!--MD5=[3928320482bb7c72570d05370269b4f7]
class TrafficLightModel--><rect codeLine="39" fill="#FEFECE" filter="url(#f1fszsm3fj72wa)" height="166.875" id="TrafficLightModel" style="stroke:#A80036;stroke-width:1.5;" width="397" x="379" y="48.5"/><ellipse cx="503.75" cy="68.5938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M505.75,65.0938 Q505.9531,64.5938 506.1875,64.3438 Q506.4219,64.0938 506.6875,64.0938 Q507.1563,64.0938 507.4531,64.375 Q507.75,64.6563 507.75,65.3125 L507.75,66.875 Q507.75,67.5313 507.4688,67.8125 Q507.1875,68.0938 506.75,68.0938 Q506.3594,68.0938 506.1094,67.9219 Q505.8594,67.75 505.75,67.2969 Q505.7031,66.9844 505.5313,66.8125 Q505.2188,66.4844 504.6563,66.2969 Q504.0938,66.0938 503.5313,66.0938 Q502.8281,66.0938 502.2344,66.375 Q501.6563,66.6563 501.2031,67.2813 Q500.75,67.9063 500.75,68.7656 L500.75,69.6875 Q500.75,70.7188 501.5938,71.4063 Q502.4375,72.0938 503.9375,72.0938 Q504.8281,72.0938 505.4531,71.8906 Q505.8125,71.7813 506.2188,71.4219 Q506.4844,71.2188 506.625,71.1563 Q506.7656,71.0938 506.9375,71.0938 Q507.2656,71.0938 507.5,71.3594 Q507.75,71.6094 507.75,71.9688 Q507.75,72.3125 507.4063,72.7188 Q506.9063,73.3125 506.1094,73.6406 Q505.0625,74.0938 503.7813,74.0938 Q502.2813,74.0938 501.0781,73.5 Q500.1094,73.0313 499.4219,72.0156 Q498.75,71 498.75,69.7969 L498.75,68.7031 Q498.75,67.4531 499.3438,66.3594 Q499.9531,65.2656 501,64.6875 Q502.0625,64.0938 503.25,64.0938 Q503.9688,64.0938 504.5938,64.3438 Q505.2188,64.5938 505.75,65.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="143" x="522.25" y="65.957">«context-implementation»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="93" x="547.25" y="81.0508">TrafficLightModel</text><line style="stroke:#A80036;stroke-width:1.5;" x1="380" x2="775" y1="88.6875" y2="88.6875"/><line style="stroke:#A80036;stroke-width:1.5;" x1="380" x2="775" y1="96.6875" y2="96.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="169" x="385" y="112.1064">changeAmberTimeout(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="224" x="385" y="125.9424">setNotifyStopped(receiver: suspend () -&gt; Unit)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="385" x="385" y="139.7783">setNotifyStateChange(receiver: suspend (newState: TrafficLightStates) -&gt; Unit)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="385" y="153.6143">stopped() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="174" x="385" y="167.4502">switchRed(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="187" x="385" y="181.2861">switchAmber(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="185" x="385" y="195.1221">switchGreen(on: Boolean) «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="258" x="385" y="208.958">stateChanged(toState: TrafficLightStates) «suspend»</text><!--MD5=[9749051c974da246c300c6b23f53e7a6]
class IntersectionStates--><rect codeLine="54" fill="#FEFECE" filter="url(#f1fszsm3fj72wa)" height="111.5313" id="IntersectionStates" style="stroke:#A80036;stroke-width:1.5;" width="131" x="1062" y="397"/><ellipse cx="1077" cy="417.0938" fill="#EB937F" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1075.5,418.0938 L1075.5,420.0938 L1079.5,420.0938 L1079.5,419.0938 L1079.5,418.6094 L1080.125,418.0938 L1080.5,418.0938 L1080.875,418.0938 L1081.5,418.6094 L1081.5,419.0938 L1081.5,422.0938 L1073.5,422.0938 L1073.0156,422.0938 L1072.5,421.4688 L1072.5,421.0938 L1072.5,420.7188 L1073.0156,420.0938 L1073.5,420.0938 L1073.5,420.0938 L1073.5,414.0938 L1073.5,414.0938 L1073.0156,414.0938 L1072.5,413.4688 L1072.5,413.0938 L1072.5,412.7188 L1073.0156,412.0938 L1073.5,412.0938 L1081.5,412.0938 L1081.5,415.0938 L1081.5,415.5781 L1080.875,416.0938 L1080.5,416.0938 L1080.125,416.0938 L1079.5,415.5781 L1079.5,415.0938 L1079.5,414.0938 L1075.5,414.0938 L1075.5,416.0938 L1076.5,416.0938 L1076.5,415.6094 L1076.5,415.6094 L1077.125,415.0938 L1077.5,415.0938 L1077.875,415.0938 L1078.5,415.6094 L1078.5,416.0938 L1078.5,418.0938 L1078.5,418.5781 L1077.875,419.0938 L1077.875,419.0938 L1077.5,419.0938 L1077.125,419.0938 L1076.5,418.5781 L1076.5,418.5781 L1076.5,418.0938 L1075.5,418.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="64" x="1108.5" y="414.457">«fsm-state»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="99" x="1091" y="429.5508">IntersectionStates</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1063" x2="1192" y1="437.1875" y2="437.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="50" x="1068" y="452.6064">STOPPING</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="43" x="1068" y="466.4424">WAITING</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="33" x="1068" y="480.2783">GOING</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="46" x="1068" y="494.1143">STOPPED</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1063" x2="1192" y1="500.5313" y2="500.5313"/><!--MD5=[335fb609bd3f47ab478c9b95fb231727]
class IntersectionEvents--><rect codeLine="61" fill="#FEFECE" filter="url(#f1fszsm3fj72wa)" height="111.5313" id="IntersectionEvents" style="stroke:#A80036;stroke-width:1.5;" width="133" x="1347" y="794"/><ellipse cx="1362" cy="814.0938" fill="#EB937F" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1360.5,815.0938 L1360.5,817.0938 L1364.5,817.0938 L1364.5,816.0938 L1364.5,815.6094 L1365.125,815.0938 L1365.5,815.0938 L1365.875,815.0938 L1366.5,815.6094 L1366.5,816.0938 L1366.5,819.0938 L1358.5,819.0938 L1358.0156,819.0938 L1357.5,818.4688 L1357.5,818.0938 L1357.5,817.7188 L1358.0156,817.0938 L1358.5,817.0938 L1358.5,817.0938 L1358.5,811.0938 L1358.5,811.0938 L1358.0156,811.0938 L1357.5,810.4688 L1357.5,810.0938 L1357.5,809.7188 L1358.0156,809.0938 L1358.5,809.0938 L1366.5,809.0938 L1366.5,812.0938 L1366.5,812.5781 L1365.875,813.0938 L1365.5,813.0938 L1365.125,813.0938 L1364.5,812.5781 L1364.5,812.0938 L1364.5,811.0938 L1360.5,811.0938 L1360.5,813.0938 L1361.5,813.0938 L1361.5,812.6094 L1361.5,812.6094 L1362.125,812.0938 L1362.5,812.0938 L1362.875,812.0938 L1363.5,812.6094 L1363.5,813.0938 L1363.5,815.0938 L1363.5,815.5781 L1362.875,816.0938 L1362.875,816.0938 L1362.5,816.0938 L1362.125,816.0938 L1361.5,815.5781 L1361.5,815.5781 L1361.5,815.0938 L1360.5,815.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="68" x="1392.5" y="811.457">«fsm-event»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="101" x="1376" y="826.5508">IntersectionEvents</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1348" x2="1479" y1="834.1875" y2="834.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="42" x="1353" y="849.6064">SWITCH,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="49" x="1353" y="863.4424">STOPPED,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="30" x="1353" y="877.2783">STOP,</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="34" x="1353" y="891.1143">START</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1348" x2="1479" y1="897.5313" y2="897.5313"/><!--MD5=[414efa38f8f745dd4728156b7dbb3d13]
class TrafficIntersection--><rect codeLine="68" fill="#FEFECE" filter="url(#f1fszsm3fj72wa)" height="263.7266" id="TrafficIntersection" style="stroke:#A80036;stroke-width:1.5;" width="398" x="728.5" y="1129"/><ellipse cx="874.75" cy="1149.0938" fill="#B4A7E5" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M875.75,1146.0938 L875.75,1152.0938 L877.75,1152.0938 L878.2344,1152.0938 L878.75,1152.7188 L878.75,1153.0938 L878.75,1153.4688 L878.2344,1154.0938 L877.75,1154.0938 L871.75,1154.0938 L871.2656,1154.0938 L870.75,1153.4688 L870.75,1153.0938 L870.75,1152.7188 L871.2656,1152.0938 L871.75,1152.0938 L873.75,1152.0938 L873.75,1146.0938 L871.75,1146.0938 L871.2656,1146.0938 L870.75,1145.4688 L870.75,1145.0938 L870.75,1144.7188 L871.2656,1144.0938 L871.75,1144.0938 L877.75,1144.0938 L878.2344,1144.0938 L878.75,1144.7188 L878.75,1145.0938 L878.75,1145.4688 L878.2344,1146.0938 L877.75,1146.0938 L875.75,1146.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="77" x="905.25" y="1146.457">«fsm-context»</text><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="97" x="895.25" y="1161.5508">TrafficIntersection</text><line style="stroke:#A80036;stroke-width:1.5;" x1="729.5" x2="1125.5" y1="1169.1875" y2="1169.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="78" x="734.5" y="1184.6064">cycleTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="99" x="734.5" y="1198.4424">cycleWaitTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="96" x="734.5" y="1212.2783">currentName: String</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="96" x="734.5" y="1226.1143">current: TrafficLight</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="734.5" y="1239.9502">listOrder: List&lt;String&gt;</text><line style="stroke:#A80036;stroke-width:1.5;" x1="729.5" x2="1125.5" y1="1246.3672" y2="1246.3672"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="386" x="734.5" y="1261.7861">setNotifyStateChange(receiver: suspend (newState: IntersectionStates) -&gt; Unit)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="224" x="734.5" y="1275.6221">setNotifyStopped(receiver: suspend () -&gt; Unit)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="260" x="734.5" y="1289.458">addTrafficLight(name: String, trafficLight: TrafficLight)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="144" x="734.5" y="1303.2939">get(name: String): TrafficLight</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="149" x="734.5" y="1317.1299">changeCycleTime(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="170" x="734.5" y="1330.9658">changeCycleWaitTime(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="202" x="734.5" y="1344.8018">stateChanged(toState: IntersectionStates)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="87" x="734.5" y="1358.6377">start() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="86" x="734.5" y="1372.4736">stop() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="86" x="734.5" y="1386.3096">next() «suspend»</text><!--MD5=[c56cb48cb5367e6a067e96aa34014d4b]
class TrafficIntersectionFSM--><rect codeLine="86" fill="#FEFECE" filter="url(#f1fszsm3fj72wa)" height="139.2031" id="TrafficIntersectionFSM" style="stroke:#A80036;stroke-width:1.5;" width="214" x="1013.5" y="780.5"/><ellipse cx="1055.95" cy="800.5938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1057.95,797.0938 Q1058.1531,796.5938 1058.3875,796.3438 Q1058.6219,796.0938 1058.8875,796.0938 Q1059.3563,796.0938 1059.6531,796.375 Q1059.95,796.6563 1059.95,797.3125 L1059.95,798.875 Q1059.95,799.5313 1059.6688,799.8125 Q1059.3875,800.0938 1058.95,800.0938 Q1058.5594,800.0938 1058.3094,799.9219 Q1058.0594,799.75 1057.95,799.2969 Q1057.9031,798.9844 1057.7313,798.8125 Q1057.4188,798.4844 1056.8563,798.2969 Q1056.2938,798.0938 1055.7313,798.0938 Q1055.0281,798.0938 1054.4344,798.375 Q1053.8563,798.6563 1053.4031,799.2813 Q1052.95,799.9063 1052.95,800.7656 L1052.95,801.6875 Q1052.95,802.7188 1053.7938,803.4063 Q1054.6375,804.0938 1056.1375,804.0938 Q1057.0281,804.0938 1057.6531,803.8906 Q1058.0125,803.7813 1058.4188,803.4219 Q1058.6844,803.2188 1058.825,803.1563 Q1058.9656,803.0938 1059.1375,803.0938 Q1059.4656,803.0938 1059.7,803.3594 Q1059.95,803.6094 1059.95,803.9688 Q1059.95,804.3125 1059.6063,804.7188 Q1059.1063,805.3125 1058.3094,805.6406 Q1057.2625,806.0938 1055.9813,806.0938 Q1054.4813,806.0938 1053.2781,805.5 Q1052.3094,805.0313 1051.6219,804.0156 Q1050.95,803 1050.95,801.7969 L1050.95,800.7031 Q1050.95,799.4531 1051.5438,798.3594 Q1052.1531,797.2656 1053.2,796.6875 Q1054.2625,796.0938 1055.45,796.0938 Q1056.1688,796.0938 1056.7938,796.3438 Q1057.4188,796.5938 1057.95,797.0938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="34" x="1119.55" y="797.957">«fsm»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="121" x="1076.05" y="813.0508">TrafficIntersectionFSM</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1014.5" x2="1226.5" y1="820.6875" y2="820.6875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="153" x="1019.5" y="836.1064">currentState: IntersectionStates</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1014.5" x2="1226.5" y1="842.5234" y2="842.5234"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="202" x="1019.5" y="857.9424">allowedEvents(): Set&lt;IntersectionEvents&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="143" x="1019.5" y="871.7783">startIntersection() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="142" x="1019.5" y="885.6143">stopIntersection() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="154" x="1019.5" y="899.4502">switchIntersection() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="1019.5" y="913.2861">stopped() «suspend»</text><!--MD5=[0f0665bbc6117e4d0d6be9272681c68f]
class TrafficIntersectionImplementation--><rect codeLine="99" fill="#FEFECE" filter="url(#f1fszsm3fj72wa)" height="402.0859" id="TrafficIntersectionImplementation" style="stroke:#A80036;stroke-width:1.5;" width="398" x="428.5" y="649"/><ellipse cx="531.75" cy="669.0938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M533.75,665.5938 Q533.9531,665.0938 534.1875,664.8438 Q534.4219,664.5938 534.6875,664.5938 Q535.1563,664.5938 535.4531,664.875 Q535.75,665.1563 535.75,665.8125 L535.75,667.375 Q535.75,668.0313 535.4688,668.3125 Q535.1875,668.5938 534.75,668.5938 Q534.3594,668.5938 534.1094,668.4219 Q533.8594,668.25 533.75,667.7969 Q533.7031,667.4844 533.5313,667.3125 Q533.2188,666.9844 532.6563,666.7969 Q532.0938,666.5938 531.5313,666.5938 Q530.8281,666.5938 530.2344,666.875 Q529.6563,667.1563 529.2031,667.7813 Q528.75,668.4063 528.75,669.2656 L528.75,670.1875 Q528.75,671.2188 529.5938,671.9063 Q530.4375,672.5938 531.9375,672.5938 Q532.8281,672.5938 533.4531,672.3906 Q533.8125,672.2813 534.2188,671.9219 Q534.4844,671.7188 534.625,671.6563 Q534.7656,671.5938 534.9375,671.5938 Q535.2656,671.5938 535.5,671.8594 Q535.75,672.1094 535.75,672.4688 Q535.75,672.8125 535.4063,673.2188 Q534.9063,673.8125 534.1094,674.1406 Q533.0625,674.5938 531.7813,674.5938 Q530.2813,674.5938 529.0781,674 Q528.1094,673.5313 527.4219,672.5156 Q526.75,671.5 526.75,670.2969 L526.75,669.2031 Q526.75,667.9531 527.3438,666.8594 Q527.9531,665.7656 529,665.1875 Q530.0625,664.5938 531.25,664.5938 Q531.9688,664.5938 532.5938,664.8438 Q533.2188,665.0938 533.75,665.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="77" x="605.25" y="666.457">«fsm-context»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="183" x="552.25" y="681.5508">TrafficIntersectionImplementation</text><line style="stroke:#A80036;stroke-width:1.5;" x1="429.5" x2="825.5" y1="689.1875" y2="689.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="97" x="434.5" y="704.6064">amberTimeout: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="78" x="434.5" y="718.4424">cycleTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="99" x="434.5" y="732.2783">cycleWaitTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="153" x="434.5" y="746.1143">currentState: IntersectionStates</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="96" x="434.5" y="759.9502">currentName: String</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="96" x="434.5" y="773.7861">current: TrafficLight</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="434.5" y="787.6221">listOrder: List&lt;String&gt;</text><line style="stroke:#A80036;stroke-width:1.5;" x1="429.5" x2="825.5" y1="794.0391" y2="794.0391"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="188" x="434.5" y="809.458">fun changeAmberTimeout(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="163" x="434.5" y="823.2939">fun get(name: String): TrafficLight</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="260" x="434.5" y="837.1299">addTrafficLight(name: String, trafficLight: TrafficLight)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="224" x="434.5" y="850.9658">setNotifyStopped(receiver: suspend () -&gt; Unit)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="386" x="434.5" y="864.8018">setNotifyStateChange(receiver: suspend (newState: IntersectionStates) -&gt; Unit)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="235" x="434.5" y="878.6377">stateChanged(toState: IntersectionStates) «fsm»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="149" x="434.5" y="892.4736">changeCycleTime(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="170" x="434.5" y="906.3096">changeCycleWaitTime(value: Long)</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="437.5" y="920.1455"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="202" x="434.5" y="933.9814">allowedEvents(): Set&lt;IntersectionEvents&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="123" x="434.5" y="947.8174">startSystem() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="122" x="434.5" y="961.6533">stopSystem() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="434.5" y="975.4893">switch() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="104" x="434.5" y="989.3252">stopped() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="437.5" y="1003.1611"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="111" x="434.5" y="1016.9971">start() «suspend, fsm»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="110" x="434.5" y="1030.833">stop() «suspend, fsm»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="110" x="434.5" y="1044.6689">next() «suspend, fsm»</text><!--MD5=[786d219eb1ef13c970a594ed816ea39a]
class TrafficIntersectionModel--><rect codeLine="133" fill="#FEFECE" filter="url(#f1fszsm3fj72wa)" height="70.0234" id="TrafficIntersectionModel" style="stroke:#A80036;stroke-width:1.5;" width="184" x="842.5" y="418"/><ellipse cx="867.4" cy="438.0938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M869.4,434.5938 Q869.6031,434.0938 869.8375,433.8438 Q870.0719,433.5938 870.3375,433.5938 Q870.8063,433.5938 871.1031,433.875 Q871.4,434.1563 871.4,434.8125 L871.4,436.375 Q871.4,437.0313 871.1188,437.3125 Q870.8375,437.5938 870.4,437.5938 Q870.0094,437.5938 869.7594,437.4219 Q869.5094,437.25 869.4,436.7969 Q869.3531,436.4844 869.1813,436.3125 Q868.8688,435.9844 868.3063,435.7969 Q867.7438,435.5938 867.1813,435.5938 Q866.4781,435.5938 865.8844,435.875 Q865.3063,436.1563 864.8531,436.7813 Q864.4,437.4063 864.4,438.2656 L864.4,439.1875 Q864.4,440.2188 865.2438,440.9063 Q866.0875,441.5938 867.5875,441.5938 Q868.4781,441.5938 869.1031,441.3906 Q869.4625,441.2813 869.8688,440.9219 Q870.1344,440.7188 870.275,440.6563 Q870.4156,440.5938 870.5875,440.5938 Q870.9156,440.5938 871.15,440.8594 Q871.4,441.1094 871.4,441.4688 Q871.4,441.8125 871.0563,442.2188 Q870.5563,442.8125 869.7594,443.1406 Q868.7125,443.5938 867.4313,443.5938 Q865.9313,443.5938 864.7281,443 Q863.7594,442.5313 863.0719,441.5156 Q862.4,440.5 862.4,439.2969 L862.4,438.2031 Q862.4,436.9531 862.9938,435.8594 Q863.6031,434.7656 864.65,434.1875 Q865.7125,433.5938 866.9,433.5938 Q867.6188,433.5938 868.2438,433.8438 Q868.8688,434.0938 869.4,434.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="73" x="912.1" y="435.457">«fsm-model»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="130" x="883.6" y="450.5508">TrafficIntersectionModel</text><line style="stroke:#A80036;stroke-width:1.5;" x1="843.5" x2="1025.5" y1="458.1875" y2="458.1875"/><line style="stroke:#A80036;stroke-width:1.5;" x1="843.5" x2="1025.5" y1="466.1875" y2="466.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="172" x="848.5" y="481.6064">get(name: String): TrafficLightModel</text><!--MD5=[ce902affe73128e0a9c1460ddb6351ac]
class TrafficIntersectionViewModel--><rect codeLine="140" fill="#90EE90" filter="url(#f1fszsm3fj72wa)" height="249.8906" id="TrafficIntersectionViewModel" style="stroke:#A80036;stroke-width:1.5;" width="301" x="811" y="7"/><ellipse cx="879.25" cy="27.0938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M881.25,23.5938 Q881.4531,23.0938 881.6875,22.8438 Q881.9219,22.5938 882.1875,22.5938 Q882.6563,22.5938 882.9531,22.875 Q883.25,23.1563 883.25,23.8125 L883.25,25.375 Q883.25,26.0313 882.9688,26.3125 Q882.6875,26.5938 882.25,26.5938 Q881.8594,26.5938 881.6094,26.4219 Q881.3594,26.25 881.25,25.7969 Q881.2031,25.4844 881.0313,25.3125 Q880.7188,24.9844 880.1563,24.7969 Q879.5938,24.5938 879.0313,24.5938 Q878.3281,24.5938 877.7344,24.875 Q877.1563,25.1563 876.7031,25.7813 Q876.25,26.4063 876.25,27.2656 L876.25,28.1875 Q876.25,29.2188 877.0938,29.9063 Q877.9375,30.5938 879.4375,30.5938 Q880.3281,30.5938 880.9531,30.3906 Q881.3125,30.2813 881.7188,29.9219 Q881.9844,29.7188 882.125,29.6563 Q882.2656,29.5938 882.4375,29.5938 Q882.7656,29.5938 883,29.8594 Q883.25,30.1094 883.25,30.4688 Q883.25,30.8125 882.9063,31.2188 Q882.4063,31.8125 881.6094,32.1406 Q880.5625,32.5938 879.2813,32.5938 Q877.7813,32.5938 876.5781,32 Q875.6094,31.5313 874.9219,30.5156 Q874.25,29.5 874.25,28.2969 L874.25,27.2031 Q874.25,25.9531 874.8438,24.8594 Q875.4531,23.7656 876.5,23.1875 Q877.5625,22.5938 878.75,22.5938 Q879.4688,22.5938 880.0938,22.8438 Q880.7188,23.0938 881.25,23.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="73" x="941.25" y="24.457">«viewmodel»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="156" x="899.75" y="39.5508">TrafficIntersectionViewModel</text><line style="stroke:#A80036;stroke-width:1.5;" x1="812" x2="1111" y1="47.1875" y2="47.1875"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="114" x="817" y="62.6064">val amberTimeout: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="116" x="817" y="76.4424">val cycleWaitTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="95" x="817" y="90.2783">val cycleTime: Long</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="113" x="817" y="104.1143">val currentName: String</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="219" x="817" y="117.9502">val trafficLights: List&lt;TrafficLightViewModel&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="0" x="820" y="131.7861"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="245" x="817" y="145.6221">val intersectionState: LiveData&lt;IntersectionStates&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="165" x="817" y="159.458">val allowStart: LiveData&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="176" x="817" y="173.2939">val allowSwitch: LiveData&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="164" x="817" y="187.1299">val allowStop: LiveData&lt;Boolean&gt;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="289" x="817" y="200.9658">val trafficLightData: List&lt;LiveData&lt;TrafficLightViewModel&gt;&gt;</text><line style="stroke:#A80036;stroke-width:1.5;" x1="812" x2="1111" y1="207.3828" y2="207.3828"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="123" x="817" y="222.8018">startSystem() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="122" x="817" y="236.6377">stopSystem() «suspend»</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacing" textLength="98" x="817" y="250.4736">switch() «suspend»</text><!--MD5=[b1d46488418bc0cd55cf54b5fc017696]
class ViewModel--><rect codeLine="160" fill="#008000" filter="url(#f1fszsm3fj72wa)" height="56.1875" id="ViewModel" style="stroke:#A80036;stroke-width:1.5;" width="91" x="1147" y="104"/><ellipse cx="1162" cy="124.0938" fill="#ADD1B2" rx="11" ry="11" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1164,120.5938 Q1164.2031,120.0938 1164.4375,119.8438 Q1164.6719,119.5938 1164.9375,119.5938 Q1165.4063,119.5938 1165.7031,119.875 Q1166,120.1563 1166,120.8125 L1166,122.375 Q1166,123.0313 1165.7188,123.3125 Q1165.4375,123.5938 1165,123.5938 Q1164.6094,123.5938 1164.3594,123.4219 Q1164.1094,123.25 1164,122.7969 Q1163.9531,122.4844 1163.7813,122.3125 Q1163.4688,121.9844 1162.9063,121.7969 Q1162.3438,121.5938 1161.7813,121.5938 Q1161.0781,121.5938 1160.4844,121.875 Q1159.9063,122.1563 1159.4531,122.7813 Q1159,123.4063 1159,124.2656 L1159,125.1875 Q1159,126.2188 1159.8438,126.9063 Q1160.6875,127.5938 1162.1875,127.5938 Q1163.0781,127.5938 1163.7031,127.3906 Q1164.0625,127.2813 1164.4688,126.9219 Q1164.7344,126.7188 1164.875,126.6563 Q1165.0156,126.5938 1165.1875,126.5938 Q1165.5156,126.5938 1165.75,126.8594 Q1166,127.1094 1166,127.4688 Q1166,127.8125 1165.6563,128.2188 Q1165.1563,128.8125 1164.3594,129.1406 Q1163.3125,129.5938 1162.0313,129.5938 Q1160.5313,129.5938 1159.3281,129 Q1158.3594,128.5313 1157.6719,127.5156 Q1157,126.5 1157,125.2969 L1157,124.2031 Q1157,122.9531 1157.5938,121.8594 Q1158.2031,120.7656 1159.25,120.1875 Q1160.3125,119.5938 1161.5,119.5938 Q1162.2188,119.5938 1162.8438,119.8438 Q1163.4688,120.0938 1164,120.5938 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="12" font-style="italic" lengthAdjust="spacing" textLength="56" x="1177.5" y="121.457">«android»</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="59" x="1176" y="136.5508">ViewModel</text><line style="stroke:#A80036;stroke-width:1.5;" x1="1148" x2="1237" y1="144.1875" y2="144.1875"/><line style="stroke:#A80036;stroke-width:1.5;" x1="1148" x2="1237" y1="152.1875" y2="152.1875"/><!--MD5=[f1980d47a4aabc5373467bd052565116]
reverse link TrafficLightStates to TrafficLightFSM--><path codeLine="35" d="M139.137,453 C162.955,453 189.436,453 212.416,453 " fill="none" id="TrafficLightStates-backto-TrafficLightFSM" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="134.098,453,143.098,457,139.098,453,143.098,449,134.098,453" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="152.25" y="446.4951">«uses»</text><!--MD5=[ef55fa34c35daebc710b7e66915eb99f]
link TrafficLightFSM to TrafficLightEvents--><path codeLine="36" d="M271.5,495.154 C271.5,569.401 271.5,725.248 271.5,802.936 " fill="none" id="TrafficLightFSM-to-TrafficLightEvents" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="271.5,807.939,275.5,798.939,271.5,802.939,267.5,798.939,271.5,807.939" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="42" x="272.5" y="615.4951">«uses»</text><!--MD5=[292b5eba46e35c966edca064dae2d052]
link TrafficLightFSM to TrafficLight--><path codeLine="37" d="M330.587,453 C352.089,453 377.78,453 404.732,453 " fill="none" id="TrafficLightFSM-to-TrafficLight" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="409.778,453,400.778,449,404.778,453,400.778,457,409.778,453" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="348.75" y="446.4951">context</text><!--MD5=[60d76a1b73914086ffca282bac55cc55]
reverse link TrafficLight to TrafficLightModel--><path codeLine="50" d="M595.158,314.7 C591.877,280.94 588.464,245.82 585.524,215.57 " fill="none" id="TrafficLight-backto-TrafficLightModel" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="602.156,314.35,597.124,334.93,588.222,315.71,602.156,314.35" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[ba58c1ed8cc93ff041287a1d4a67abe5]
link TrafficLightModel to TrafficLightFSM--><path codeLine="51" d="M489.9916,224.2295 C489.9916,224.2295 365.425,354.08 320.137,401.296 " fill="none" id="TrafficLightModel-TrafficLightFSM" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="311.121,410.695,320.2381,406.9695,314.5824,407.0869,314.4651,401.4312,311.121,410.695" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="314.5824" x2="320.1205" y1="407.0869" y2="401.314"/><polygon fill="#A80036" points="498.299,215.57,491.2588,217.1306,489.9916,224.2295,497.0318,222.6689,498.299,215.57" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[4f82a78b9551ca4724c4bd6b04fae35e]
link TrafficIntersectionFSM to TrafficIntersection--><path codeLine="95" d="M1087.98,919.919 C1061.75,975.5 1024.05,1055.4 991.775,1123.789 " fill="none" id="TrafficIntersectionFSM-to-TrafficIntersection" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="989.461,1128.693,996.9201,1122.2617,991.5954,1124.1714,989.6856,1118.8467,989.461,1128.693" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43" x="1007.5" y="1095.4951">context</text><!--MD5=[9468340d7453291c53dc9c139c20e995]
link TrafficIntersectionFSM to IntersectionEvents--><path codeLine="96" d="M1227.52,850 C1265.54,850 1307.39,850 1341.75,850 " fill="none" id="TrafficIntersectionFSM-to-IntersectionEvents" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="1346.76,850,1337.76,846,1341.76,850,1337.76,854,1346.76,850" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83" x="1245.75" y="843.4951">events «uses»</text><!--MD5=[bc9580e42e84a1ee7481eb826584436c]
reverse link IntersectionStates to TrafficIntersectionFSM--><path codeLine="97" d="M1126.43,514.417 C1125.16,586.111 1123.05,705.361 1121.71,780.444 " fill="none" id="IntersectionStates-backto-TrafficIntersectionFSM" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="1126.52,509.339,1122.3612,518.2667,1126.4314,514.3382,1130.36,518.4084,1126.52,509.339" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="1125.5" y="615.4951">states «uses»</text><!--MD5=[c6620b3d535ccfb80a893f8bbc381de5]
link TrafficIntersectionImplementation to TrafficIntersection--><path codeLine="127" d="M774.204,1051.007 C789.43,1071.765 804.701,1092.584 819.39,1112.61 " fill="none" id="TrafficIntersectionImplementation-to-TrafficIntersection" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="825.119,1108.585,831.304,1128.852,813.83,1116.866,825.119,1108.585" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[f0a08e09aca32d07a41c75b7d758ec68]
link TrafficIntersectionImplementation to TrafficIntersectionFSM--><path codeLine="128" d="M838.601,850 C838.601,850 951.969,850 1000.339,850 " fill="none" id="TrafficIntersectionImplementation-TrafficIntersectionFSM" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1013.41,850,1004.41,846,1008.41,850,1004.41,854,1013.41,850" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1008.41" x2="1000.41" y1="850" y2="850"/><polygon fill="#A80036" points="826.601,850,832.601,854,838.601,850,832.601,846,826.601,850" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150" x="845" y="843.4951">intersectionFSM «private»</text><!--MD5=[70580b9585bbdb19fca88c9b5ea435f5]
reverse link TrafficLightFSM to TrafficIntersectionImplementation--><path codeLine="129" d="M311.817,499.048 C341.548,532.242 382.999,578.472 419.5,619 C428.327,628.801 437.37,638.833 446.506,648.961 " fill="none" id="TrafficLightFSM-backto-TrafficIntersectionImplementation" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="308.251,495.065,311.276,504.4378,311.5869,498.7895,317.2352,499.1004,308.251,495.065" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="420.5" y="615.4951">stateMachines «creates,private»</text><!--MD5=[b94219f37a15c045c6fd9350fcfebf52]
reverse link TrafficLight to TrafficIntersectionImplementation--><path codeLine="130" d="M614.387,576.387 C615.498,599.477 616.686,624.177 617.876,648.93 " fill="none" id="TrafficLight-backto-TrafficIntersectionImplementation" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="614.136,571.177,610.5726,580.3586,614.376,576.1712,618.5634,579.9746,614.136,571.177" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121" x="617.5" y="615.4951">trafficLights «private»</text><!--MD5=[eba362b83840c153a80c602e5795c94f]
reverse link TrafficLightModel to TrafficIntersectionModel--><path codeLine="137" d="M688.548,218.71 C732.025,253.57 781.648,295.01 824.5,335 C852.934,361.54 883.043,393.893 904.558,417.849 " fill="none" id="TrafficLightModel-backto-TrafficIntersectionModel" style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#A80036" points="684.629,215.57,689.1502,224.3198,688.5306,218.697,694.1534,218.0773,684.629,215.57" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57" x="787.5" y="301.4951">«creates»</text><!--MD5=[6ecf9d780bbabd50b2cf76fc88256124]
link TrafficIntersectionModel to TrafficIntersectionImplementation--><path codeLine="138" d="M908.06,488.019 C881.936,521.631 839.614,576.085 795.673,632.621 " fill="none" id="TrafficIntersectionModel-to-TrafficIntersectionImplementation" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="801.049,637.111,783.249,648.606,789.995,628.519,801.049,637.111" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[3d4c01f7763e20d4b520dc35ddf75d5c]
link TrafficIntersectionViewModel to TrafficIntersectionModel--><path codeLine="158" d="M950.984,257.25 C946.293,312.66 941.097,374.06 937.816,412.82 " fill="none" id="TrafficIntersectionViewModel-to-TrafficIntersectionModel" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="937.386,417.902,942.1302,409.2711,937.8074,412.9198,934.1587,408.5969,937.386,417.902" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[359f91098a131ebf7cbff9e5ef62884e]
link TrafficIntersectionViewModel to ViewModel--><path codeLine="159" d="M1112.19,132 C1116.95,132 1121.72,132 1126.48,132 " fill="none" id="TrafficIntersectionViewModel-to-ViewModel" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="1126.7,125,1146.7,132,1126.7,139,1126.7,125" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[42806566c64491f6f876a356f06068e9]
@startuml

enum TrafficLightStates <<fsm-state>> {
    RED
    AMBER
    GREEN
}

enum TrafficLightEvents <<fsm-event>> {
    STOP
    GO
}

interface TrafficLight <<fsm-context>> {
    name: String
    amberTimeout: Long
    amber: Boolean
    red: Boolean
    green: Boolean

    changeAmberTimeout(value: Long)
    setNotifyStopped(receiver: suspend () -> Unit)
    setNotifyStateChange(receiver: suspend (newState: TrafficLightStates) -> Unit)
    stopped() <<suspend>>
    switchRed(on: Boolean) <<suspend>>
    switchAmber(on: Boolean) <<suspend>>
    switchGreen(on: Boolean) <<suspend>>
    stateChanged(toState: TrafficLightStates) <<suspend>>
}

class TrafficLightFSM <<fsm>> {
    fun start() <<suspend>>
    fun stop() <<suspend>>
}

TrafficLightFSM .left.> TrafficLightStates: <<uses>>
TrafficLightFSM ..> TrafficLightEvents: <<uses>>
TrafficLightFSM -right-> TrafficLight: context

class TrafficLightModel <<context-implementation>> {
    changeAmberTimeout(value: Long)
    setNotifyStopped(receiver: suspend () -> Unit)
    setNotifyStateChange(receiver: suspend (newState: TrafficLightStates) -> Unit)
    stopped() <<suspend>>
    switchRed(on: Boolean) <<suspend>>
    switchAmber(on: Boolean) <<suspend>>
    switchGreen(on: Boolean) <<suspend>>
    stateChanged(toState: TrafficLightStates) <<suspend>>
}

TrafficLightModel -left-|> TrafficLight
TrafficLightModel *- -> TrafficLightFSM


enum IntersectionStates <<fsm-state>> {
    STOPPING
    WAITING
    GOING
    STOPPED
}

enum IntersectionEvents <<fsm-event>> {
    SWITCH,
    STOPPED,
    STOP,
    START
}

interface TrafficIntersection <<fsm-context>> {
    cycleTime: Long
    cycleWaitTime: Long
    setNotifyStateChange(receiver: suspend (newState: IntersectionStates) -> Unit)
    setNotifyStopped(receiver: suspend () -> Unit)
    addTrafficLight(name: String, trafficLight: TrafficLight)
    currentName: String
    current: TrafficLight
    listOrder: List<String>
    get(name: String): TrafficLight
    changeCycleTime(value: Long)
    changeCycleWaitTime(value: Long)
    stateChanged(toState: IntersectionStates)
    start() <<suspend>>
    stop() <<suspend>>
    next() <<suspend>>
}

class TrafficIntersectionFSM <<fsm>> {
    currentState: IntersectionStates
    allowedEvents(): Set<IntersectionEvents>
    startIntersection() <<suspend>>
    stopIntersection() <<suspend>>
    switchIntersection() <<suspend>>
    stopped() <<suspend>>
}

TrafficIntersectionFSM - -> TrafficIntersection: context
TrafficIntersectionFSM .right.> IntersectionEvents: events <<uses>>
TrafficIntersectionFSM .up.> IntersectionStates: states <<uses>>

class TrafficIntersectionImplementation <<fsm-context>> {
    amberTimeout: Long
    cycleTime: Long
    cycleWaitTime: Long
    currentState: IntersectionStates
    currentName: String
    current: TrafficLight
    listOrder: List<String>
    fun changeAmberTimeout(value: Long)
    fun get(name: String): TrafficLight
    addTrafficLight(name: String, trafficLight: TrafficLight)
    setNotifyStopped(receiver: suspend () -> Unit)
    setNotifyStateChange(receiver: suspend (newState: IntersectionStates) -> Unit)
    stateChanged(toState: IntersectionStates) <<fsm>>
    changeCycleTime(value: Long)
    changeCycleWaitTime(value: Long)

    allowedEvents(): Set<IntersectionEvents>
    startSystem() <<suspend>>
    stopSystem() <<suspend>>
    switch() <<suspend>>
    stopped() <<suspend>>

    start() <<suspend, fsm>>
    stop() <<suspend, fsm>>
    next() <<suspend, fsm>>
}

TrafficIntersectionImplementation - -|> TrafficIntersection
TrafficIntersectionImplementation *-right-> TrafficIntersectionFSM: intersectionFSM <<private>>
TrafficIntersectionImplementation -left-> TrafficLightFSM: stateMachines <<creates,private>>
TrafficIntersectionImplementation -up-> TrafficLight: trafficLights <<private>>


class TrafficIntersectionModel <<fsm-model>> {
    get(name: String): TrafficLightModel
}

TrafficIntersectionModel .left.> TrafficLightModel: <<creates>>
TrafficIntersectionModel -down-|> TrafficIntersectionImplementation

class TrafficIntersectionViewModel <<viewmodel>> #lightgreen {
    val amberTimeout: Long
    val cycleWaitTime: Long
    val cycleTime: Long
    val currentName: String
    val trafficLights: List<TrafficLightViewModel>

    val intersectionState: LiveData<IntersectionStates>
    val allowStart: LiveData<Boolean>
    val allowSwitch: LiveData<Boolean>
    val allowStop: LiveData<Boolean>
    val trafficLightData: List<LiveData<TrafficLightViewModel>>

    startSystem() <<suspend>>
    stopSystem() <<suspend>>
    switch() <<suspend>>
}

TrafficIntersectionViewModel - -> TrafficIntersectionModel
TrafficIntersectionViewModel -right-|> ViewModel
class ViewModel <<android>> #green {
}

@enduml

PlantUML version 1.2021.7(Sun May 23 14:40:07 CAT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: en
Country: ZA
--></g></svg>